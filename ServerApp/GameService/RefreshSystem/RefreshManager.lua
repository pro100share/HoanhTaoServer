_G.CRefreshManager = CSingle:new();CSingleManager:AddSingle(CRefreshManager,true);local minu,hour,day = 60*1000,60*60*1000,24*60*60*1000-----------------------------------------------------------------------------------------------function CRefreshManager:Create()	self.tabLastUpdate = {};	self.tabNextUpdate = {};	for dwDataID,tabConfig in pairs(RefreshConfig) do		if not tabConfig.bNoUpdate then			local szUpdate = tabConfig.szUpdate;			local dwIndex = string.find(szUpdate,':');			local dwH = tonumber(string.sub(szUpdate,1,dwIndex-1));			local dwM = tonumber(string.sub(szUpdate,dwIndex+1));			local dwUpdate = dwH * hour + dwM * minu;			local dwNow = GetCurTime();			local dwToday = dwNow - dwNow % day;			if dwToday + dwUpdate > dwNow then				self.tabNextUpdate[dwDataID] = dwToday + dwUpdate;				self.tabLastUpdate[dwDataID] = dwToday + dwUpdate - day;			else				self.tabLastUpdate[dwDataID] = dwToday + dwUpdate;				self.tabNextUpdate[dwDataID] = dwToday + dwUpdate + day;			end		end	end	return true;end;function CRefreshManager:Update(dwInterval)	local dwNow = GetCurTime();	for dwDataID,dwUpdate in pairs(self.tabNextUpdate) do		if dwUpdate < dwNow then			local dwValue = RefreshConfig[dwDataID].dwValue;			local tabPlayerList = CMapManager:GetPlayer();			for dwRoleID, objPlayer in pairs(tabPlayerList) do				local objSystem = objPlayer:GetSystem("CRefreshSystem");				objSystem:UpdateData(dwDataID,dwValue);			end			self.tabLastUpdate[dwDataID] = dwNow;			self.tabNextUpdate[dwDataID] = dwNow + day;		end	end	return true;end;-----------------------------------------------------------------------------------------------function CRefreshManager:GetLastUpdate(dwDataID)	return self.tabLastUpdate[dwDataID];endfunction CRefreshManager:GetNextUpdate(dwDataID)	return self.tabNextUpdate[dwDataID];end-----------------------------------------------------------------------------------------------