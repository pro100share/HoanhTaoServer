------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------上/下马------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------上马function CMountSystem:RideUp(nShift)	--print("==================", nShift);	local objPlayer = self:GetPlayer();	if not objPlayer then		_err("CMountSystem:RideUp() get player err!!!");		return;	end;	--判断激活状态	if (self.n_ActiveMountID or 0) > 0 then 		--如果当前为骑乘状态		local mountInst = self:GetMountInst(self.n_ActiveMountID);		if not mountInst then return end;		if self:GetState() then			self.nShift = nShift;			objPlayer:SetMount(mountInst:GetEnumID(nShift, objPlayer:GetInfo().dwProf));			self:AddMountEffect(#mountInst:GetChangeRank());		else			local stateSystem = objPlayer:GetSystem("CStateSystem");			if stateSystem then				local state = stateSystem:GetState();				if state == enPlayerState.ePS_Sit or state == enPlayerState.ePS_Dead then					--向客户端同步数据					objPlayer.MountSys_SynchronizeRideStateMsg{						RideState = self.b_State;					};					return;				end;			end;			self.b_State = true;			self:AttributeChange();			self.nShift = nShift;			objPlayer:SetMount(mountInst:GetEnumID(nShift, objPlayer:GetInfo().dwProf));			self:AddMountEffect(#mountInst:GetChangeRank());			--向客户端同步数据			objPlayer.MountSys_SynchronizeRideStateMsg{				RideState = self.b_State;			};		end;	end;end;--下马function CMountSystem:RideDown()	local objPlayer = self:GetPlayer();	if not objPlayer then		_err("CMountSystem:RideDown() get player err!!!");		return;	end;	--判断激活状态	if (self.n_ActiveMountID or 0) > 0 then 		local mountInst = self:GetMountInst(self:GetActiveMountID());		--如果当前为非骑乘状态		if not self:GetState() then return end;		self.b_State = false;		self:AttributeChange();		objPlayer:SetMount(0);				if mountInst then			self:DelMountEffect(#mountInst:GetChangeRank());		end		--向客户端同步数据		objPlayer.MountSys_SynchronizeRideStateMsg{			RideState = self.b_State;		};	end;end;--被伤害，有几率下马function CMountSystem:BeHurt()	if self:GetState() then		local n_Rate = math.random(1, 10000);		if n_Rate <= _G.CMountSystemConfig.OnHurtRideDownRate then			self:RideDown();		end;	end;end;