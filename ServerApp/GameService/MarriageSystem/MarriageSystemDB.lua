--[[功能：婚姻系统数据库操作版本：	v1.0	2012-03-05 create by lkj]]_G.CMarriageSystemDB = {}function CMarriageSystemDB:new(objDB, objSys)	local obj = {}	obj.m_ObjDB = objDB;	obj.m_ObjSys = objSys;	for i, v in pairs(CMarriageSystemDB) do		if type(v) == "function" then			obj[i] = v;		end;	end;	return obj;end;--检查系统数据库模块有效性function CMarriageSystemDB:CheckDBValidityAndGetRoleID()	if not self.m_ObjDB then		_info("self.m_ObjDB is null by CMarriageSystemDB");		return false;	end;	if not self.m_ObjSys then		_info("self.m_ObjSys is null by CMarriageSystemDB");		return false;	end;	local objPlayer = self.m_ObjSys:GetPlayer();	if not objPlayer then		_info("objPlayer is null by CMarriageSystemDB");		return false;	end;    local dwRoleID = objPlayer:GetRoleID();	if dwRoleID == 0 then		_info("dwRoleID == 0  by CMarriageSystemDB");		return false;	end;	return true, dwRoleID;end;--------------------------------------------------------------------------------------------------------------------------------婚宴相关----------------------------------------------------------------------------------------------------------------------------------记录吃婚宴列表function CMarriageSystemDB:SaveEatBanquetInfo(eatBanquetList, eatTime)	local validity, RoleID = self:CheckDBValidityAndGetRoleID();	if not validity then 		_info("DB invalidity by CMarriageSystemDB:SaveEatBanquetInfo");		return false;	end;	local tempStr = "";	for line, data in pairs(eatBanquetList) do		for npcID, v in pairs(data) do			tempStr = tempStr .. tostring(line) .. "," .. tostring(npcID) .. ";";		end;	end;	local UpdateCmd = self.m_ObjDB:CreateUpdateCmd("T_Role_MarriageRoleEatInfo");	UpdateCmd.Wheres.RoleID         = RoleID;	UpdateCmd.Fields.LastEatTime	= eatTime;	UpdateCmd.Fields.NpcInfo		= tempStr;	UpdateCmd:execute()	return true;end;