--[[功能：成就系统消息处理（服务器）版本：v1.0作者：郭肇义时间：2012-04-12]]_define()--客户端请求成就事件信息列表define.GetAchievementInfoMsg{	user = NONE,}when{user = NONE}GetAchievementInfoMsg = checkUser;when{}function GetAchievementInfoMsg(user)	local objSystem = user:GetSystem("CAchievementSystem");	local tabData = objSystem:GetInfo();	--tabData = AchievementParseList(tabData,AchievementInfoListMsgStN)	local tabTemp,dwCount = {},0;	for k,v in pairs(tabData) do		tabTemp[k] = v;		dwCount = dwCount + 1;		if dwCount >= 20 then			user.OnGetAchievementInfoMsg { TabInfo = tabTemp };			tabTemp,dwCount = {},0;		end	end	user.OnGetAchievementInfoMsg { TabInfo = tabTemp };		objSystem:GetInitMedalInfo();end;--客户端请求他人成就信息define.GetAchievementOtherInfoMsg{	user = NONE,	RoleID = 0,}when{user = NONE}GetAchievementOtherInfoMsg = checkUser;when{}function GetAchievementOtherInfoMsg(user,RoleID)	local objSystem = user:GetSystem("CAchievementSystem")	print("GetAchievementOtherInfoMsg, RoleID", RoleID)	objSystem:GetOtherInfo(RoleID)end;--客户端请求成就比较信息define.GetAchievementCompareInfoMsg{	user = NONE,	RoleID = 0,}when{user = NONE}GetAchievementCompareInfoMsg = checkUser;when{}function GetAchievementCompareInfoMsg(user,RoleID)	local objSystem = user:GetSystem("CAchievementSystem")	objSystem:GetCompareInfo(RoleID)		local objSystem = user:GetSystem('CPlayerEventCenterSystem')	objSystem:DoEvent(enumPlayerEventType.EventRequestAchievementCompare)end;--客户端请求获得成就奖励define.GetAchievementRewardMsg{	user = NONE,	AchievementID = 0,}when{user = NONE}GetAchievementRewardMsg = checkUser;when{}function GetAchievementRewardMsg(user,AchievementID)	local objSystem = user:GetSystem("CAchievementSystem");	objSystem:GetReward(AchievementID);end;--客户端请求玩家IDdefine.GetAchievementPlayerIDMsg{	user = NONE,	RoleName = '',}when{user = NONE}GetAchievementPlayerIDMsg = checkUser;when{}function GetAchievementPlayerIDMsg(user,RoleName)	local objSystem = user:GetSystem("CAchievementSystem");	local dwRoleID = user:GetInfo().dwRoleID;	CKernelApp.KSGetAchievementPlayerIDMsg {RoleID = dwRoleID,RoleName = RoleName}end;define.OnKSGetAchievementPlayerIDMsg{	user = NONE,	RoleID = 0,}when{user = NONE}OnKSGetAchievementPlayerIDMsg = checkKSUser;when{}function OnKSGetAchievementPlayerIDMsg(user,RoleID)	if RoleID == 0 then		user.OnAchievementNoticeMsg { Type = 1, StringID = 3000410003 }	else		user.OnGetAchievementPlayerIDMsg { RoleID = RoleID }	endend;--客户端请求玩家是否存在define.CheckAchievementPlayerMsg{	user = NONE,	RoleID = 0,	Oper = 0,}when{user = NONE}CheckAchievementPlayerMsg = checkUser;when{}function CheckAchievementPlayerMsg(user,RoleID,Oper)	local Result = false	if RoleID ~= 0 then		local objPlayer = user:GetOtherPlayer(RoleID,3);		if objPlayer then			Result = true		end	end	user.OnCheckAchievementPlayerMsg {		RoleID = RoleID,		Oper = Oper,		Result = Result,	}end;--初始化隐藏成就信息define.OnKSInitHideAchievementListMsg{	AchievementList = {}}when{}function OnKSInitHideAchievementListMsg(AchievementList)	CAchievementSystemManager:SetHideAchievementList(AchievementList)end;--添加隐藏成就信息define.OnKSAddHideAchievementMsg{	AchievementID = 0,	RoleID = 0,	RoleName = '',}when{}function OnKSAddHideAchievementMsg(AchievementID,RoleID,RoleName)	CAchievementSystemManager:AddHideAchievement(AchievementID,RoleID,RoleName)end;--激活勋章define.OnActiveMedalRequestMsg{	user = NONE,	MedalID = 0;}when{user = NONE}OnActiveMedalRequestMsg = checkUser;when{}function OnActiveMedalRequestMsg(user,MedalID)	local objSystem = user:GetSystem("CAchievementSystem");	objSystem:ActiveMedal(MedalID);end;