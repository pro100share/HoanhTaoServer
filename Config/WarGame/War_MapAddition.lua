--战场地图相关_G.War_MapAddition = {};--龙鼎战每分钟奖励function War_MapAddition:GuildMinute(objWar,objPlayer)	local objWarSystem = objPlayer:GetSystem("CWarSystem");	if not objWarSystem then		return;	end		local Level = objPlayer:GetLevel();		local integral = objWarSystem:GetMyWarScore()		--占领亢龙鼎的数量	local pot1num=math.floor(integral/100)	--占领潜龙鼎的数量	local pot2num=math.floor((integral-pot1num*100)/10)	--占领应龙鼎的数量	local pot3num=math.floor(integral-pot1num*100-pot2num*10)		local Join = WarAddition.LongDing		--龙鼎加成	local Lv = (pot3num*Join.Low) + (pot2num*Join.Centre) + (pot1num*Join.Tall)	--经验奖励	local Base = (Level-30)*50+2000;	--五行奖励	local WuXing = Level;	local tbInfo = {};		tbInfo.jingyan = math.floor(Base*(Join.Multiple+Lv));	tbInfo.zhenqi_G = math.floor(WuXing*(Join.Multiple+Lv));	tbInfo.zhenqi_M = math.floor(WuXing*(Join.Multiple+Lv));	tbInfo.zhenqi_S = math.floor(WuXing*(Join.Multiple+Lv));	tbInfo.zhenqi_H = math.floor(WuXing*(Join.Multiple+Lv));	tbInfo.zhenqi_T = math.floor(WuXing*(Join.Multiple+Lv));		objWarSystem:AddHarvest(tbInfo);end;--盟主战--分钟奖励function War_MapAddition:LeaderReward(objWar,objPlayer,objWarSystem)	local Area = War_MapAddition:Detection(8020,objPlayer)	local Level = objPlayer:GetLevel();	--经验	local Base = (Level-30)*50+2000;	--五行真气	local Wood = Level;	--每分钟收益	local tbInfo = {};	tbInfo.jingyan = math.floor(Base*Area);	tbInfo.zhenqi_G = math.floor(Wood*Area);	tbInfo.zhenqi_M = math.floor(Wood*Area);	tbInfo.zhenqi_S = math.floor(Wood*Area);	tbInfo.zhenqi_H = math.floor(Wood*Area);	tbInfo.zhenqi_T = math.floor(Wood*Area);	objWarSystem:AddHarvest(tbInfo);endlocal Arithmetic  = function(Rank,Step)	local a1 = Rank - 30	local n = Step	local Basis = 3000	local Base = ((a1*n)+a1*(a1-1)*n/2)+Basis	return Baseend---戏说天下function War_MapAddition:XiShuoTianXia(objWar,objPlayer,objWarSystem)	local Level = objPlayer:GetLevel();	local BeiShu = 1;	--判断buff	local objBufSys = objPlayer:GetSystem("CBuffSystem");	if not objBufSys then		return;	end		--如果有相同BUFF返回	if objBufSys:GetBuffObj(50600000) ~= nil then		BeiShu = 2;	end;		if (ActivityConfig.Exp[1]) and (ActivityConfig.Exp[1].value or 0) > 0 then		BeiShu = BeiShu + ActivityConfig.Exp[1].value	end	local Base = Arithmetic(Level,50)	--经验		--五行真气	local Wood = Level*4;	--每分钟收益	local tbInfo = {};	tbInfo.jingyan = math.floor(Base*BeiShu);	tbInfo.zhenqi_G = math.floor(Wood*BeiShu);	tbInfo.zhenqi_M = math.floor(Wood*BeiShu);	tbInfo.zhenqi_S = math.floor(Wood*BeiShu);	tbInfo.zhenqi_H = math.floor(Wood*BeiShu);	tbInfo.zhenqi_T = math.floor(Wood*BeiShu);	objWarSystem:AddHarvest(tbInfo);end--检测角色当前位置function War_MapAddition:Detection(map,objPlayer)	local objMapSystem = objPlayer:GetSystem("CMapSystem");	if not objMapSystem then		return false;	end	local vPos = objMapSystem:GetPlayerPos()	for k,n in pairs(_G.MapAreaConfig) do		if (n.dwMapID == map) then			local t = n.AreaTable[1]			local m = n.AreaTable[2]			if (vPos.x >=t.val1 and vPos.x <=t.val3 and vPos.y >=t.val2 and vPos.y <=t.val4) then				return 20;			elseif (vPos.x >=m.val1 and vPos.x <=m.val3 and vPos.y >=m.val2 and vPos.y <=m.val4) then				return 10;			else				return 5;			end		end	endend